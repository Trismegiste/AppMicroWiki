{% extends 'mobile.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="/css/autocomplete.css"/>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="/js/textcomplete.min.js"></script>
    <script>
        var Textarea = Textcomplete.editors.Textarea
        var editor = new Textarea(document.getElementById('sentence_content'));
        var textcomplete = new Textcomplete(editor);

        textcomplete.register([{
                match: /(^|\s)\[\[(\w+)$/,
                search: function (term, callback) {
                    fetch('{{ path('app_sentencecrud_searchlinks', {title: document.title}) }}' + '/' + term)
                            .then((response) => {
                                return response.json();
                            })
                            .then((data) => {
                                console.log(data);
                                callback(data);
                            });
                },
                replace: function (value) {
                    return '$1[[' + value + ']] ';
                }
            }]);
    </script>
{% endblock %}
